<!DOCTYPE html>
<html lang="en">
<script src="/js/src/photoswipe.min.js?v="></script>
<script src="/js/src/photoswipe-ui-default.min.js?v="></script>
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 5.4.1">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">

<link rel="stylesheet" href="//fonts.googleapis.com/css?family=Noto Serif SC:300,300italic,400,400italic,700,700italic|Source Code Pro:300,300italic,400,400italic,700,700italic&display=swap&subset=latin,latin-ext">
<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"blog.caohr.com","root":"/","scheme":"Pisces","version":"7.8.0","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12,"onmobile":false},"copycode":{"enable":true,"show_result":true,"style":"flat"},"back2top":{"enable":true,"sidebar":false,"scrollpercent":true},"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":"disqus","storage":true,"lazyload":false,"nav":null,"activeClass":"disqus"},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":false,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}}};
  </script>

  <meta name="description" content="åœ¨ç±»æ²¡æœ‰å®Œå…¨åˆå§‹åŒ–ä¹‹å‰ï¼Œä½ ä¸èƒ½ä½¿ç”¨ä»–ï¼Œä½¿ç”¨ä»–åŒ…å«è®¿é—®å±æ€§ã€è®¾ç½®å±æ€§ã€è°ƒç”¨æ–¹æ³•ã€‚æœ¬ç¯‡ä¸»è¦è®²è§£ç»“æ„ä½“çš„åˆå§‹åŒ–ï¼Œç»“æ„ä½“ä¼šåœ¨æ²¡æœ‰è‡ªå®šä¹‰åˆå§‹åŒ–æ–¹æ³•çš„æƒ…å†µä¸‹è‡ªåŠ¨ä¸ºæ‰€æœ‰çš„stored propertieså‡½æ•°åˆ›å»ºé»˜è®¤çš„åˆå§‹åŒ–æ–¹æ³•ï¼Œä½†æ˜¯å¦‚æœä½ è‡ªå·±æä¾›äº†åˆå§‹åŒ–æ–¹æ³•ï¼Œé‚£ä¹ˆè‡ªåŠ¨çš„åˆå§‹åŒ–æ–¹æ³•å°±ä¼šå¤±æ•ˆï¼Œä½†æ˜¯ä¹Ÿå¯ä»¥æŠŠè‡ªå®šä¹‰çš„åˆå§‹åŒ–æ–¹æ³•å†™åœ¨æ‰©å±•ä¸­è¿™æ ·ç¼–è¯‘å™¨è¿˜æ˜¯ä¼šä¸ºä¸»ä½“çš„ç»“æ„ä½“åˆ›å»ºé»˜è®¤çš„åˆå§‹åŒ–æ–¹æ³•ï¼Œé»˜è®¤åˆ›å»ºçš„åˆå§‹åŒ–æ–¹æ³•ä½ ä¸èƒ½æ›´æ”¹">
<meta property="og:type" content="article">
<meta property="og:title" content="Swift Tutorial&#x2F;Initialization In Depth Part 1">
<meta property="og:url" content="https://blog.caohr.com/2021/12/16/Swift/Swift%20Tutorial:%20Initialization%20In%20Depth%20Part%201/index.html">
<meta property="og:site_name" content="HR&#39;s Blog">
<meta property="og:description" content="åœ¨ç±»æ²¡æœ‰å®Œå…¨åˆå§‹åŒ–ä¹‹å‰ï¼Œä½ ä¸èƒ½ä½¿ç”¨ä»–ï¼Œä½¿ç”¨ä»–åŒ…å«è®¿é—®å±æ€§ã€è®¾ç½®å±æ€§ã€è°ƒç”¨æ–¹æ³•ã€‚æœ¬ç¯‡ä¸»è¦è®²è§£ç»“æ„ä½“çš„åˆå§‹åŒ–ï¼Œç»“æ„ä½“ä¼šåœ¨æ²¡æœ‰è‡ªå®šä¹‰åˆå§‹åŒ–æ–¹æ³•çš„æƒ…å†µä¸‹è‡ªåŠ¨ä¸ºæ‰€æœ‰çš„stored propertieså‡½æ•°åˆ›å»ºé»˜è®¤çš„åˆå§‹åŒ–æ–¹æ³•ï¼Œä½†æ˜¯å¦‚æœä½ è‡ªå·±æä¾›äº†åˆå§‹åŒ–æ–¹æ³•ï¼Œé‚£ä¹ˆè‡ªåŠ¨çš„åˆå§‹åŒ–æ–¹æ³•å°±ä¼šå¤±æ•ˆï¼Œä½†æ˜¯ä¹Ÿå¯ä»¥æŠŠè‡ªå®šä¹‰çš„åˆå§‹åŒ–æ–¹æ³•å†™åœ¨æ‰©å±•ä¸­è¿™æ ·ç¼–è¯‘å™¨è¿˜æ˜¯ä¼šä¸ºä¸»ä½“çš„ç»“æ„ä½“åˆ›å»ºé»˜è®¤çš„åˆå§‹åŒ–æ–¹æ³•ï¼Œé»˜è®¤åˆ›å»ºçš„åˆå§‹åŒ–æ–¹æ³•ä½ ä¸èƒ½æ›´æ”¹">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="http://blog.caohr.com/ImagesFolder/SwiftInitInDepth-0.png">
<meta property="og:image" content="http://blog.caohr.com/ImagesFolder/SwiftInitInDepth-3-480x45.png">
<meta property="og:image" content="http://blog.caohr.com/ImagesFolder/SwiftInitInDepth-2.png">
<meta property="og:image" content="https://blog.caohr.com/2021/12/16/Swift/Swift%20Tutorial:%20Initialization%20In%20Depth%20Part%201/okay">
<meta property="og:image" content="http://blog.caohr.com/ImagesFolder/Mars_Hubble-320x320.jpg">
<meta property="og:image" content="http://blog.caohr.com/ImagesFolder/SwiftInitInDepth-5-480x66.png">
<meta property="og:image" content="http://blog.caohr.com/ImagesFolder/Struct2PhaseInit-700x248.png">
<meta property="article:published_time" content="2021-12-16T15:57:31.502Z">
<meta property="article:modified_time" content="2022-01-08T05:39:58.709Z">
<meta property="article:author" content="HR">
<meta property="article:tag" content="Ray Wenderlich">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="http://blog.caohr.com/ImagesFolder/SwiftInitInDepth-0.png">

<link rel="canonical" href="https://blog.caohr.com/2021/12/16/Swift/Swift%20Tutorial:%20Initialization%20In%20Depth%20Part%201/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : false,
    isPost : true,
    lang   : 'en'
  };
</script>

  <title>Swift Tutorial/Initialization In Depth Part 1 | HR's Blog</title>
  
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-61905451-1"></script>
<script>
window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-61905451-1');
</script>


  <script>
    var _hmt = _hmt || [];
    (function() {
      var hm = document.createElement("script");
      hm.src = "https://hm.baidu.com/hm.js?1b08dac8932c829229886a7ff2235549";
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(hm, s);
    })();
  </script>




  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

<!-- hexo injector head_end start -->
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.css">
<!-- hexo injector head_end end --></head>

<body itemscope itemtype="http://schema.org/WebPage">
<!-- ç›¸å†Œç›¸å…³ä»£ç å¼€å§‹ -->
  
<!-- ç›¸å†Œç›¸å…³ä»£ç ç»“æŸ -->
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="Toggle navigation bar">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <h1 class="site-title">HR's Blog</h1>
      <span class="logo-line-after"><i></i></span>
    </a>
      <p class="site-subtitle" itemprop="description">Swimming ğŸŠ in the seağŸŒŠof code!</p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
    </div>
  </div>
</div>




<nav class="site-nav">
  <ul id="menu" class="main-menu menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-home fa-fw"></i>Home</a>

  </li>
        <li class="menu-item menu-item-categories">

    <a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>Categories</a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>Archives</a>

  </li>
        <li class="menu-item menu-item-tags">

    <a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>Tags</a>

  </li>
        <li class="menu-item menu-item-photos">

    <a href="/album/" rel="section"><i class="fa fa-camera fa-fw"></i>Photos</a>

  </li>
        <li class="menu-item menu-item-about">

    <a href="/about/" rel="section"><i class="fa fa-user fa-fw"></i>About</a>

  </li>
  </ul>
</nav>




</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>
  <div class="reading-progress-bar"></div>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content post posts-expand">
            

    
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="https://blog.caohr.com/2021/12/16/Swift/Swift%20Tutorial:%20Initialization%20In%20Depth%20Part%201/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.png">
      <meta itemprop="name" content="HR">
      <meta itemprop="description" content="Swimming ğŸŠ in the seağŸŒŠof code!">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="HR's Blog">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          Swift Tutorial/Initialization In Depth Part 1
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2021-12-16 23:57:31" itemprop="dateCreated datePublished" datetime="2021-12-16T23:57:31+08:00">2021-12-16</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2022-01-08 13:39:58" itemprop="dateModified" datetime="2022-01-08T13:39:58+08:00">2022-01-08</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Swift/" itemprop="url" rel="index"><span itemprop="name">Swift</span></a>
                </span>
            </span>

          
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="far fa-comment"></i>
      </span>
      <span class="post-meta-item-text">Disqus: </span>
    
    <a title="disqus" href="/2021/12/16/Swift/Swift%20Tutorial:%20Initialization%20In%20Depth%20Part%201/#disqus_thread" itemprop="discussionUrl">
      <span class="post-comments-count disqus-comment-count" data-disqus-identifier="2021/12/16/Swift/Swift Tutorial: Initialization In Depth Part 1/" itemprop="commentCount"></span>
    </a>
  </span>
  
  

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
        <p>åœ¨ç±»æ²¡æœ‰å®Œå…¨åˆå§‹åŒ–ä¹‹å‰ï¼Œä½ ä¸èƒ½ä½¿ç”¨ä»–ï¼Œä½¿ç”¨ä»–åŒ…å«è®¿é—®å±æ€§ã€è®¾ç½®å±æ€§ã€è°ƒç”¨æ–¹æ³•ã€‚<br>æœ¬ç¯‡ä¸»è¦è®²è§£ç»“æ„ä½“çš„åˆå§‹åŒ–ï¼Œç»“æ„ä½“ä¼šåœ¨æ²¡æœ‰è‡ªå®šä¹‰åˆå§‹åŒ–æ–¹æ³•çš„æƒ…å†µä¸‹è‡ªåŠ¨ä¸ºæ‰€æœ‰çš„<code>stored properties</code>å‡½æ•°åˆ›å»ºé»˜è®¤çš„åˆå§‹åŒ–æ–¹æ³•ï¼Œä½†æ˜¯å¦‚æœä½ è‡ªå·±æä¾›äº†åˆå§‹åŒ–æ–¹æ³•ï¼Œé‚£ä¹ˆè‡ªåŠ¨çš„åˆå§‹åŒ–æ–¹æ³•å°±ä¼šå¤±æ•ˆï¼Œä½†æ˜¯ä¹Ÿå¯ä»¥æŠŠè‡ªå®šä¹‰çš„åˆå§‹åŒ–æ–¹æ³•å†™åœ¨æ‰©å±•ä¸­è¿™æ ·ç¼–è¯‘å™¨è¿˜æ˜¯ä¼šä¸ºä¸»ä½“çš„ç»“æ„ä½“åˆ›å»ºé»˜è®¤çš„åˆå§‹åŒ–æ–¹æ³•ï¼Œé»˜è®¤åˆ›å»ºçš„åˆå§‹åŒ–æ–¹æ³•ä½ ä¸èƒ½æ›´æ”¹åˆå§‹åŒ–å‚æ•°çš„é¡ºåºï¼Œç³»ç»Ÿé»˜è®¤æ ¹æ®ä½ åœ¨ç»“æ„ä½“å†™çš„é¡ºåºæ¥åˆ›å»ºã€‚<br>å¯¹äº<code>optional</code>çš„å€¼ä¸éœ€è¦åœ¨åˆå§‹åŒ–æ–¹æ³•ä¸­èµ‹å€¼ï¼Œå› ä¸º<code>optional</code>çš„æ–¹æ³•é»˜è®¤ä¼šèµ‹å€¼ä¸º<code>nil</code>ã€‚<br>ä½ ä¹Ÿå¯ä»¥ä¸º<code>Init</code>æ–¹æ³•ä¸ºéœ€è¦ä¼ å…¥å‚æ•°è®¾ç½®é»˜è®¤å€¼ï¼Œè¿™æ ·ä½ åœ¨åˆ›å»ºçš„æ—¶å€™å°±å¯ä»¥ç›´æ¥è°ƒç”¨<code>()</code>,è€Œä¸æ˜¯éœ€è¦ä¼ å…¥å…¶ä»–çš„å€¼ã€‚å½“å› ä¸ºä¼ å…¥çš„å€¼ä¸ä¸€æ ·è€Œæœ‰å¤šä¸ª<code>Init</code>æ–¹æ³•çš„æ—¶å€™ï¼Œè¿™æ—¶å€™å°±å¯ä»¥ç”¨<code>delegating initializer</code>æ–¹æ³•æ¥è§£å†³ã€‚<code>delegating initializer</code>åœ¨ç½‘ç»œæ¡†æ¶<code>Alamofire</code>é‡Œé¢å¤§é‡è¢«ä½¿ç”¨ï¼Œä¾‹å¦‚ç”¨æˆ·å¦‚æœä¸æŒ‡å®šè¯·æ±‚æ–¹æ³•é»˜è®¤å°±ä¼šä½¿ç”¨<code>get</code>æ–¹æ³•ï¼Œä¸æŒ‡å®šé…ç½®å°±ä½¿ç”¨é»˜è®¤çš„é…ç½®ã€‚<br>å¯¹äºä¼ å…¥å‚æ•°ä¸åˆæ³•ï¼Œ<code>init</code>æ–¹æ³•å¯ä»¥é€šè¿‡<code>Optional</code>å’Œ<code>throws</code>ä¸¤ç§æ–¹æ³•æ¥å‘Šè¯‰åˆå§‹åŒ–å¤±è´¥ã€‚</p>
<span id="more"></span>

<p>Some things are inherently awesome: rockets, missions to Mars, initialization in Swift. This tutorial combines all three for a combo-platter of awesomeness in which youâ€™ll get to learn about the power of initialization!</p>
<p>Initialization in Swift is about what happens when you create a new instance of a named type:</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> number <span class="operator">=</span> <span class="type">Float</span>()</span><br></pre></td></tr></table></figure>
<p>Initialization is the time to manage the inital values of stored properties for named types: classes, structures, and enumerations. Because of the safety features built into Swift, initialization can be tricky. There are a lot of rules, some of which are not obvious.</p>
<p>By following this two-part tutorial, you will learn the ins and outs to designing initializers for your Swift types. In Part 1, youâ€™ll begin with the basics including structure initialization, and in Part 2 youâ€™ll move on to learning about class initialization.<br>ç¬¬ä¸€éƒ¨åˆ†åŒ…å«ç»“æ„ä½“çš„åˆå§‹åŒ–ï¼Œç¬¬äºŒéƒ¨åˆ†åŒ…å«ç±»çš„åˆå§‹åŒ–ã€‚</p>
<p>Before getting started, you should be familiar with the basics of initialization in Swift and be comfortable with concepts such as optional types, throwing and handling errors, and declaring default stored property values. Also, make sure you have Xcode 8.0 or later installed.</p>
<p>If you need a refresher on the basics, or if you are just starting to learn Swift, check out our bookÂ <a target="_blank" rel="noopener" href="http://www.raywenderlich.com/store/swift-apprentice">Swift Apprentice</a>Â or our manyÂ <a target="_blank" rel="noopener" href="http://www.raywenderlich.com/category/swift">Swift intro tutorials</a>.</p>
<h2 id="Getting-Started"><a href="#Getting-Started" class="headerlink" title="Getting Started"></a>Getting Started</h2><p>Letâ€™s set the scene: itâ€™s your first day on your new job as a launch software engineer at NASA (go you!). Youâ€™ve been tasked with designing the data model that will drive the launch sequence for the first manned mission to Mars, Mars Unum. Of course, the first thing you do is convince the team to use Swift. Then â€¦</p>
<p>Open Xcode and create a new playground namedÂ <em>BlastOff</em>. You can select any platform, since the code in this tutorial is platform-agnostic and depends only on Foundation.</p>
<p>åœ¨ç±»æ²¡æœ‰å®Œå…¨åˆå§‹åŒ–ä¹‹å‰ï¼Œä½ ä¸èƒ½ä½¿ç”¨ä»–ã€‚ä½¿ç”¨å®ƒåŒ…æ‹¬ï¼Œè®¿é—®å±æ€§ï¼Œè®¾ç½®å±æ€§ï¼Œè°ƒç”¨æ–¹æ³•ã€‚<br>Throughout the tutorial, remember this one golden rule: <code>You cannot use an instance until it is fully initialized</code>. â€œUseâ€ of an instance includes accessing properties, setting properties and calling methods. Everything in Part 1 applies specifically to structures unless otherwise specified.</p>
<h2 id="Banking-on-the-Default-Initializer"><a href="#Banking-on-the-Default-Initializer" class="headerlink" title="Banking on the Default Initializer"></a>Banking on the Default Initializer</h2><p>To start modeling the launch sequence, declare a new structure namedÂ <code>RocketConfiguration</code>Â in your playground:</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">RocketConfiguration</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>Below the closing curly brace of the definition forÂ <code>RocketConfiguration</code>, initialize a constant instance namedÂ <code>athena9Heavy</code>:</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> athena9Heavy <span class="operator">=</span> <span class="type">RocketConfiguration</span>()</span><br></pre></td></tr></table></figure>
<p>å½“ç»“æ„ä½“æˆ–è€…ç±»é‡Œé¢æ²¡æœ‰éœ€è¦åˆå§‹åŒ–çš„å­˜å‚¨å‚æ•°ï¼Œæˆ–è€…æ‰€æœ‰çš„å€¼éƒ½æä¾›äº†é»˜è®¤çš„å­˜å‚¨å‚æ•°çš„æ—¶å€™ï¼Œå¯ä»¥ç”¨ç³»ç»Ÿé»˜è®¤å¬çš„åˆå§‹åŒ–æ–¹æ³•ä¹Ÿå°±æ˜¯ç”¨<code>()</code>æ¥åˆå§‹åŒ–ã€‚<br>This uses aÂ <em>default initializer</em>Â to instantiateÂ <code>athena9Heavy</code>. In the default initializer, the name of the type is followed by empty parentheses. You can use default initializers when your types either donâ€™t have any stored properties, or all of the typeâ€™s stored properties have default values. This holds true for both structures and classes.</p>
<p>Add the following three stored properties inside the struct definition:</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> name: <span class="type">String</span> <span class="operator">=</span> <span class="string">&quot;Athena 9 Heavy&quot;</span></span><br><span class="line"><span class="keyword">let</span> numberOfFirstStageCores: <span class="type">Int</span> <span class="operator">=</span> <span class="number">3</span></span><br><span class="line"><span class="keyword">let</span> numberOfSecondStageCores: <span class="type">Int</span> <span class="operator">=</span> <span class="number">1</span></span><br></pre></td></tr></table></figure>
<p>Notice how the default initializer still works. The code continues to run because all the stored properties have default values. That means the default initializer doesnâ€™t have very much work to do since youâ€™ve provided defaults!</p>
<p>What about optional types? Add aÂ <em>variable</em>Â stored property namedÂ <code>numberOfStageReuseLandingLegs</code>Â to the struct definition:</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> numberOfStageReuseLandingLegs: <span class="type">Int</span>?</span><br></pre></td></tr></table></figure>
<p>In our NASA scenario, some of the rockets are reusable, while others are not. Thatâ€™s whyÂ <code>numberOfStageReuseLandingLegs</code>Â is an optionalÂ <code>Int</code>. The default initializer continues to run fine because optional stored property variables are initialized toÂ <code>nil</code>Â by default. However, thatâ€™sÂ <em>not</em>Â the case with constants. å¯¹äº<code>Optional</code>çš„å€¼ç³»ç»Ÿé»˜è®¤ä¼šç»™<code>nil</code>çš„å€¼ã€‚æ‰€ä»¥ä»ç„¶å¯ä»¥ç”¨é»˜è®¤çš„åˆå§‹åŒ–ã€‚</p>
<p>ChangeÂ <code>numberOfStageReuseLandingLegs</code>Â from a variable to a constant:<br>ä½†æ˜¯å¦‚æœæŠŠ<code>var</code>æ”¹ä¸º<code>let</code>ï¼Œç¼–è¯‘å™¨å°±ä¼šæŠ¥é”™ã€‚</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> numberOfStageReuseLandingLegs: <span class="type">Int</span>?</span><br></pre></td></tr></table></figure>

<p>Notice how the playground reports a compiler error:</p>
<p><a href="http://blog.caohr.com/ImagesFolder/SwiftInitInDepth-0.png"><img src="http://blog.caohr.com/ImagesFolder/SwiftInitInDepth-0.png"></a></p>
<p>You wonâ€™t run into this often, since constant optionals are rarely needed. To fix the compiler error, assign a default value ofÂ <code>nil</code>Â toÂ <code>numberOfStageReuseLandingLegs</code>:<br>å°†<code>nil</code>èµ‹å€¼ç»™<code>numberOfStageReuseLandingLegs</code>ï¼Œè¿™æ ·çš„èµ‹å€¼æ²¡æœ‰æ„ä¹‰ï¼Œåé¢ä¹Ÿæ— æ³•åœ¨å¯¹è¿™ä¸ªå€¼è¿›è¡Œä¿®æ”¹ã€‚åªæ˜¯æ»¡è¶³äº†ç¼–è¯‘å™¨</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> numberOfStageReuseLandingLegs: <span class="type">Int</span>? <span class="operator">=</span> <span class="literal">nil</span></span><br></pre></td></tr></table></figure>

<p>Hooray! The compiler is happy again, and initialization succeeds. With this setup,Â <code>numberOfStageReuseLandingLegs</code>Â will never have a non-nil value. You cannot change it after initialization, since it is declared as a constant.</p>
<h2 id="Banking-on-the-Memberwise-Initializer"><a href="#Banking-on-the-Memberwise-Initializer" class="headerlink" title="Banking on the Memberwise Initializer"></a>Banking on the Memberwise Initializer</h2><p>Rockets are usually made up of severalÂ <em>stages</em>, which is the next thing to model. Declare a new struct namedÂ <code>RocketStageConfiguration</code>Â at the bottom of the playground:</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">RocketStageConfiguration</span> </span>&#123;</span><br><span class="line">        <span class="keyword">let</span> propellantMass: <span class="type">Double</span></span><br><span class="line">        <span class="keyword">let</span> liquidOxygenMass: <span class="type">Double</span></span><br><span class="line">        <span class="keyword">let</span> nominalBurnTime: <span class="type">Int</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>This time, you have three stored propertiesÂ <code>propellantMass</code>,Â <code>liquidOxygenMass</code>Â andÂ <code>nominalBurnTime</code>Â with no default values.</p>
<p>Create an instance ofÂ <code>RocketStageConfiguration</code>Â for the rocketâ€™s first stage:</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> stageOneConfiguration <span class="operator">=</span> <span class="type">RocketStageConfiguration</span>(</span><br><span class="line">                                                                                                        propellantMass: <span class="number">119.1</span>,</span><br><span class="line">                                                                                                        liquidOxygenMass: <span class="number">276.0</span>, </span><br><span class="line">                                                                                                        nominalBurnTime: <span class="number">180</span>)</span><br></pre></td></tr></table></figure>

<p>None ofÂ <code>RocketStageConfiguration</code>â€˜s stored properties have default values. Also, there is no initializer implemented forÂ <code>RocketStageConfiguration</code>. Why isnâ€™t there a compiler error? Swift structures (and only structures) automatically generate aÂ <em>memberwise initializer</em>. This means you get a ready-made initializer for all the stored properties that donâ€™t have default values. This is super handy, but there are several gotchas.<br><code>Swift</code>è‡ªåŠ¨ä¼šä¸º<code>Struct</code>è‡ªåŠ¨åˆ›å»ºä¸ºæ¯ä¸ª<code>stored properties</code>çš„å±æ€§åˆ›å»º<code>numberwise initializer</code>æ–¹æ³•ã€‚</p>
<p>Imagine you submit this snippet for code review and your developer team lead tells you all properties should be ordered alphabetically.</p>
<p>Update theÂ <code>RocketStageConfiguration</code>Â to re-order the stored properties:</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">RocketStageConfiguration</span> </span>&#123;</span><br><span class="line">        <span class="keyword">let</span> liquidOxygenMass: <span class="type">Double</span></span><br><span class="line">        <span class="keyword">let</span> nominalBurnTime: <span class="type">Int</span></span><br><span class="line">        <span class="keyword">let</span> propellantMass: <span class="type">Double</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><a target="_blank" rel="noopener" href="https://koenig-media.raywenderlich.com/uploads/2015/11/SwiftInitInDepth-3.png"><img src="http://blog.caohr.com/ImagesFolder/SwiftInitInDepth-3-480x45.png"></a></p>
<p><code>Struct</code>è‡ªåŠ¨ç”Ÿæˆçš„<code>numberwise initializer</code>æ–¹æ³•åªä¼šæŒ‰ç…§ä½ çš„å†™çš„å‚æ•°çš„é¡ºåºç”Ÿæˆã€‚è°ƒæ¢é¡ºåºæ˜¯ä¸è¡Œçš„ã€‚<br>What happened? TheÂ <code>stageOneConfiguaration</code>Â initializer call is no longer valid, because the automatic memberwise initializer argument listâ€™s order mirrors that of the stored property list. Be careful, because when re-ordering structure properties, you might break instance initialization. Thankfully the compiler should catch the error, but it is definitely something to watch out for.</p>
<p>Undo the stored property re-order change to get the playground compiling and running again:</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">RocketStageConfiguration</span> </span>&#123;</span><br><span class="line">        <span class="keyword">let</span> propellantMass: <span class="type">Double</span></span><br><span class="line">        <span class="keyword">let</span> liquidOxygenMass: <span class="type">Double</span></span><br><span class="line">        <span class="keyword">let</span> nominalBurnTime: <span class="type">Int</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>All your rockets burn for 180 seconds, so itâ€™s not useful to pass the nominal burn time every time you instantiate a stage configuration. SetÂ <code>nominalBurnTime</code>â€˜s default property value to 180:</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> nominalBurnTime: <span class="type">Int</span> <span class="operator">=</span> <span class="number">180</span></span><br></pre></td></tr></table></figure>

<p>Now thereâ€™s another compiler error:</p>
<p><a href="http://blog.caohr.com/ImagesFolder/SwiftInitInDepth-2.png"><img src="http://blog.caohr.com/ImagesFolder/SwiftInitInDepth-2.png"></a><br>å› ä¸º<code>memberwise initializers</code>åªä¸ºæ²¡æœ‰é»˜è®¤å€¼çš„<code>stored properties</code>æä¾›åˆå§‹åŒ–æ–¹æ³•ï¼Œä¸€æ—¦ä½ æä¾›äº†é»˜è®¤å€¼ï¼Œé‚£ä¹ˆè¿™ä¸ªå€¼å°±ä¼šä»åˆå§‹åŒ–æ–¹æ³•ä¸­å‰”é™¤ã€‚<br>Compilation fails because memberwise initializers only provide parameters for stored properties without default values. In this case, the memberwise initializer only takes in propellant mass and liquid oxygen mass, since there is already a default value for burn time.</p>
<p>RemoveÂ <code>nominalBurnTime</code>â€˜s default value so that there is no compiler error.</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> nominalBurnTime: <span class="type">Int</span></span><br></pre></td></tr></table></figure>

<p>Next, add a custom initializer to the struct definition that provides a default value for burn time:</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">init</span>(<span class="params">propellantMass</span>: <span class="type">Double</span>, <span class="params">liquidOxygenMass</span>: <span class="type">Double</span>)</span> &#123;</span><br><span class="line">  <span class="keyword">self</span>.propellantMass <span class="operator">=</span> propellantMass</span><br><span class="line">  <span class="keyword">self</span>.liquidOxygenMass <span class="operator">=</span> liquidOxygenMass</span><br><span class="line">  <span class="keyword">self</span>.nominalBurnTime <span class="operator">=</span> <span class="number">180</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>Notice that the same compiler error is back onÂ <code>stageOneConfiguration</code>!</p>
<p><a href="http://blog.caohr.com/ImagesFolder/SwiftInitInDepth-2.png"><img src="okay"></a></p>
<p>å¦‚æœä½ å®šä¹‰äº†åˆå§‹åŒ–æ–¹æ³•ï¼Œé‚£ä¹ˆè‡ªåŠ¨çš„åˆå§‹åŒ–æ–¹æ³•å°±ä¼šå¤±æ•ˆã€‚<br>Wait, shouldnâ€™t this work? All you did was provide an alternative initializer, but the originalÂ <code>stageOneConfiguration</code>Â initialization should work because itâ€™s using the automatic memberwise initializer. This is where it gets tricky: you only get a memberwise initializer if a structure does not define any initializers. As soon as you define an initializer, you lose the automatic memberwise initializer. </p>
<p>In other words, Swift will help you out to start. But as soon as you add yourÂ <em>own</em>Â initializer, it assumes you want it to get out of the way.</p>
<p>Remove theÂ <code>nominalBurnTime</code>Â argument fromÂ <code>stageOneConfiguration</code>â€˜s initialization:</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> stageOneConfiguration <span class="operator">=</span> <span class="type">RocketStageConfiguration</span>(propellantMass: <span class="number">119.1</span>,</span><br><span class="line">  liquidOxygenMass: <span class="number">276.0</span>)</span><br></pre></td></tr></table></figure>
<p>All is good again! :]</p>
<p>But what if you still need the automatic memberwise initializer? You can certainly write the equivalent initializer, but thatâ€™s a lot of work. Instead,Â <em>move</em>Â the custom initializer into anÂ <code>extension</code>Â <em>before</em>Â you instantiate an instance.<br>å¦‚æœä½ æ—¢æƒ³è¦ç³»ç»Ÿä¸ºä½ æä¾›çš„é»˜è®¤çš„åˆå§‹åŒ–æ–¹æ³•ï¼Œåˆæƒ³è‡ªå®šä¹‰çš„åˆå§‹åŒ–æ–¹æ³•ï¼Œé‚£ä¹ˆä½ å¯ä»¥æŠŠè‡ªå®šä¹‰çš„åˆå§‹åŒ–æ–¹æ³•å†™åœ¨æ‰©å±•é‡Œé¢ã€‚<br>Your struct will now be in two parts: the main definition, and an extension with your two-parameter initializer:</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">    <span class="class"><span class="keyword">struct</span> <span class="title">RocketStageConfiguration</span> </span>&#123;</span><br><span class="line">            <span class="keyword">let</span> propellantMass: <span class="type">Double</span></span><br><span class="line">            <span class="keyword">let</span> liquidOxygenMass: <span class="type">Double</span></span><br><span class="line">            <span class="keyword">let</span> nominalBurnTime: <span class="type">Int</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">extension</span> <span class="title">RocketStageConfiguration</span> </span>&#123;</span><br><span class="line">        <span class="function"><span class="keyword">init</span>(<span class="params">propellantMass</span>: <span class="type">Double</span>, <span class="params">liquidOxygenMass</span>: <span class="type">Double</span>)</span> &#123;</span><br><span class="line">                <span class="keyword">self</span>.propellantMass <span class="operator">=</span> propellantMass</span><br><span class="line">                <span class="keyword">self</span>.liquidOxygenMass <span class="operator">=</span> liquidOxygenMass</span><br><span class="line">                <span class="keyword">self</span>.nominalBurnTime <span class="operator">=</span> <span class="number">180</span></span><br><span class="line">        &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>Notice howÂ <code>stageOneConfiguration</code>Â continues to initialize successfully with two parameters. Now re-add theÂ <code>nominalBurnTime</code>Â parameter toÂ <code>stageOneConfiguration</code>â€˜s initialization:</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> stageOneConfiguration <span class="operator">=</span> <span class="type">RocketStageConfiguration</span>(propellantMass: <span class="number">119.1</span>,</span><br><span class="line">  liquidOxygenMass: <span class="number">276.0</span>, nominalBurnTime: <span class="number">180</span>)</span><br></pre></td></tr></table></figure>

<p>That works too! If the main struct definition doesnâ€™t include any initializers, Swift will still automatically generate the default memberwise initializer. Then you can add your custom ones via extensions to get the best of both worlds.</p>
<h2 id="Implementing-a-Custom-Initializer"><a href="#Implementing-a-Custom-Initializer" class="headerlink" title="Implementing a Custom Initializer"></a>Implementing a Custom Initializer</h2><p>å®ç°è‡ªå®šä¹‰çš„åˆå§‹åŒ–æ–¹æ³•<br>Weather plays a key role in launching rockets, so youâ€™ll need to address that in the data model. Declare a new struct namedÂ <code>Weather</code>Â as follows:</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Weather</span> </span>&#123;</span><br><span class="line">        <span class="keyword">let</span> temperatureCelsius: <span class="type">Double</span></span><br><span class="line">        <span class="keyword">let</span> windSpeedKilometersPerHour: <span class="type">Double</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>TheÂ <code>struct</code>Â has stored properties for temperature in degrees Celsius and wind speed in kilometers per hour.</p>
<p>Implement aÂ <em>custom initializer</em>Â forÂ <code>Weather</code>Â that takes in temperature in degrees Fahrenheit and wind speed in miles per hour. Add this code below the stored properties:</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">init</span>(<span class="params">temperatureFahrenheit</span>: <span class="type">Double</span>, <span class="params">windSpeedMilesPerHour</span>: <span class="type">Double</span>)</span> &#123;</span><br><span class="line">        <span class="keyword">self</span>.temperatureCelsius <span class="operator">=</span> (temperatureFahrenheit <span class="operator">-</span> <span class="number">32</span>) <span class="operator">/</span> <span class="number">1.8</span></span><br><span class="line">        <span class="keyword">self</span>.windSpeedKilometersPerHour <span class="operator">=</span> windSpeedMilesPerHour <span class="operator">*</span> <span class="number">1.609344</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>Defining a custom initializer is very similar to defining a method, because an initializerâ€™s argument list behaves exactly the same as a methodâ€™s. For example, you can define a default argument value for any of the initializer parameters.<br>ç»™<code>init</code>æ–¹æ³•ä¸­çš„å‚æ•°æä¾›åˆå§‹å€¼ï¼Œè¿™æ ·åœ¨åˆå§‹åŒ–çš„æ—¶å€™å¯ä»¥ç›´æ¥ç”¨é»˜è®¤çš„å€¼åˆå§‹åŒ–ã€‚<br>Change the definition of the initializer to:</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">init</span>(<span class="params">temperatureFahrenheit</span>: <span class="type">Double</span> <span class="operator">=</span> <span class="number">72</span>, <span class="params">windSpeedMilesPerHour</span>: <span class="type">Double</span> <span class="operator">=</span> <span class="number">5</span>)</span> &#123;</span><br><span class="line"><span class="operator">...</span></span><br></pre></td></tr></table></figure>

<p>Now if you call the initializer with no parameters, youâ€™ll get some sensible defaults. At the end of your playground file, create an instance ofÂ <code>Weather</code>Â and check its values:</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> currentWeather <span class="operator">=</span> <span class="type">Weather</span>()</span><br><span class="line">currentWeather.temperatureCelsius</span><br><span class="line">currentWeather.windSpeedKilometersPerHour</span><br></pre></td></tr></table></figure>

<p>Cool, right? The default initializer uses the default values provided by the custom initializer. The implementation of the custom initializer converts the values into metric system equivalents and stores the values. When you check the values of the stored properties in the playground sidebar, youâ€™ll get the correct values in degrees Celsius (22.2222) and kilometers per hour (8.047).</p>
<p>An initializerÂ <em>must</em>Â assign a value to every single stored property that does not have a default value, or else youâ€™ll get a compiler error. Remember that optionalÂ <em>variables</em>Â automatically have a default value ofÂ <code>nil</code>.å¯¹äºoptionalçš„å€¼è‡ªåŠ¨èµ‹å€¼ä¸ºnil</p>
<p>Next, changeÂ <code>currentWeather</code>Â to use your custom initializer with new values:</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> currentWeather <span class="operator">=</span> <span class="type">Weather</span>(temperatureFahrenheit: <span class="number">87</span>, windSpeedMilesPerHour: <span class="number">2</span>)</span><br></pre></td></tr></table></figure>
<p>As you can see, custom values work just as well in the initializer as default values. The playground sidebar should now show 30.556 degrees and 3.219 km/h.</p>
<p>Thatâ€™s how you implement and call a custom initializer. Your weather struct is ready to contribute to your mission to launch humans to Mars. Good work!</p>
<p><img src="http://blog.caohr.com/ImagesFolder/Mars_Hubble-320x320.jpg" alt="By NASA and The Hubble Heritage Team (STScI/AURA)"></p>
<p>By NASA and The Hubble Heritage Team (STScI/AURA) â€“Â <a target="_blank" rel="noopener" href="http://hubblesite.org/newscenter/archive/releases/2001/24/image/a/">Source</a></p>
<h2 id="Avoiding-Duplication-with-Initializer-Delegation"><a href="#Avoiding-Duplication-with-Initializer-Delegation" class="headerlink" title="Avoiding Duplication with Initializer Delegation"></a>Avoiding Duplication with Initializer Delegation</h2><p>å½“éœ€è¦æä¾›å¤šä¸ª<code>initializer</code>æ–¹æ³•çš„æ—¶å€™ï¼Œå„ä¸ªæ–¹æ³•ä¹‹é—´åªæ˜¯æœ‰éƒ¨åˆ†å€¼ä¸ç›¸åŒï¼Œè¿™æ—¶å€™å°±å¯ä»¥é€šè¿‡<code>delegating initializer</code>æ¥è§£å†³ï¼Œ<code>delegating initializer</code>åœ¨å¾ˆå¤šå¼€æºåº“é‡Œé¢éƒ½æœ‰åº”ç”¨ã€‚<br>Itâ€™s time to think about rocket guidance. Rockets need fancy guidance systems to keep them flying perfectly straight. Declare a new structure namedÂ <code>GuidanceSensorStatus</code>Â with the following code:</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">GuidanceSensorStatus</span> </span>&#123;</span><br><span class="line">        <span class="keyword">var</span> currentZAngularVelocityRadiansPerMinute: <span class="type">Double</span></span><br><span class="line">        <span class="keyword">let</span> initialZAngularVelocityRadiansPerMinute: <span class="type">Double</span></span><br><span class="line">        <span class="keyword">var</span> needsCorrection: <span class="type">Bool</span></span><br><span class="line">        </span><br><span class="line">        <span class="function"><span class="keyword">init</span>(<span class="params">zAngularVelocityDegreesPerMinute</span>: <span class="type">Double</span>, <span class="params">needsCorrection</span>: <span class="type">Bool</span>)</span> &#123;</span><br><span class="line">                <span class="keyword">let</span> radiansPerMinute <span class="operator">=</span> zAngularVelocityDegreesPerMinute <span class="operator">*</span> <span class="number">0.01745329251994</span></span><br><span class="line">                <span class="keyword">self</span>.currentZAngularVelocityRadiansPerMinute <span class="operator">=</span> radiansPerMinute</span><br><span class="line">                <span class="keyword">self</span>.initialZAngularVelocityRadiansPerMinute <span class="operator">=</span> radiansPerMinute</span><br><span class="line">                <span class="keyword">self</span>.needsCorrection <span class="operator">=</span> needsCorrection</span><br><span class="line">        &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>This struct holds the rocketâ€™s current and initial angular velocity for the z-axis (how much itâ€™s spinning). The struct also keeps track of whether or not the rocket needs a correction to stay on its target trajectory.</p>
<p>The custom initializer holds important business logic: how to convert degrees per minute to radians per minute. The initializer also sets the initial value of the angular velocity to keep for reference.</p>
<p>Youâ€™re happily coding away when the guidance engineers show up. They tell you that a new version of the rocket will give you anÂ <code>Int</code>Â forÂ <code>needsCorrection</code>Â instead of aÂ <code>Bool</code>. The engineers say a positive integer should be interpreted asÂ <code>true</code>, while zero and negative should be interpreted asÂ <code>false</code>. Your team is not ready to change the rest of the code yet, since this change is part of a future feature. So how can you accommodate the guidance engineers while still keeping your structure definition intact?</p>
<p>No sweat â€” add the following custom initializer below the first initializer:</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">init</span>(<span class="params">zAngularVelocityDegreesPerMinute</span>: <span class="type">Double</span>, <span class="params">needsCorrection</span>: <span class="type">Int</span>)</span> &#123;</span><br><span class="line">        <span class="keyword">let</span> radiansPerMinute <span class="operator">=</span> zAngularVelocityDegreesPerMinute <span class="operator">*</span> <span class="number">0.01745329251994</span></span><br><span class="line">        <span class="keyword">self</span>.currentZAngularVelocityRadiansPerMinute <span class="operator">=</span> radiansPerMinute</span><br><span class="line">        <span class="keyword">self</span>.initialZAngularVelocityRadiansPerMinute <span class="operator">=</span> radiansPerMinute</span><br><span class="line">        <span class="keyword">self</span>.needsCorrection <span class="operator">=</span> (needsCorrection <span class="operator">&gt;</span> <span class="number">0</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>This new initializer takes anÂ <code>Int</code>Â instead of aÂ <code>Bool</code>Â as the final parameter. However, theÂ <code>needsCorrection</code>stored property is still aÂ <code>Bool</code>, and you set correctly according to their rules.</p>
<p>After you write this code though, something inside tells you there must be a better way. Thereâ€™s so much repetition of the rest of the initializer code! And if thereâ€™s a bug in the calculation of the degrees to radians conversion, youâ€™ll have to fix it in multiple places â€” an avoidable mistake. This is whereÂ <em>initializer delegation</em>Â comes in handy.</p>
<p>Replace the initializer you just wrote with the following:</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">init</span>(<span class="params">zAngularVelocityDegreesPerMinute</span>: <span class="type">Double</span>, <span class="params">needsCorrection</span>: <span class="type">Int</span>)</span> &#123;</span><br><span class="line">        <span class="keyword">self</span>.<span class="keyword">init</span>(zAngularVelocityDegreesPerMinute: zAngularVelocityDegreesPerMinute,</span><br><span class="line">        needsCorrection: (needsCorrection <span class="operator">&gt;</span> <span class="number">0</span>))</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>This initializer is aÂ <em>delegating initializer</em>Â and, exactly as it sounds, it delegates initialization to another initializer. To delegate, just call any other initializer onÂ <code>self</code>.</p>
<p>Delegate initialization is useful when you want to provide an alternate initializer argument list but you donâ€™t want to repeat logic that is in your custom initializer. Also, using delegating initializers helps reduce the amount of code you have to write.</p>
<p>To test the initializer, instantiate a variable namedÂ <code>guidanceStatus</code>:</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> guidanceStatus <span class="operator">=</span> <span class="type">GuidanceSensorStatus</span>(zAngularVelocityDegreesPerMinute: <span class="number">2.2</span>, needsCorrection: <span class="number">0</span>)</span><br><span class="line">guidanceStatus.currentZAngularVelocityRadiansPerMinute <span class="comment">// 0.038</span></span><br><span class="line">guidanceStatus.needsCorrection <span class="comment">// false</span></span><br></pre></td></tr></table></figure>

<p>The playground should compile and run, and the two values you checked for theÂ <code>guidanceStatus</code> properties will be in the sidebar.</p>
<p>One more thing â€” youâ€™ve been asked to provide another initializer that defaultsÂ <code>needsCorrection</code>Â to false. That should be as easy as creating a new delegating initializer and setting theÂ <code>needsCorrection</code>Â property inside before delegating initialization. Try adding the following initializer to the struct, and note that it wonâ€™t compile.</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">init</span>(<span class="params">zAngularVelocityDegreesPerMinute</span>: <span class="type">Double</span>)</span> &#123;</span><br><span class="line">        <span class="keyword">self</span>.needsCorrection <span class="operator">=</span> <span class="literal">false</span></span><br><span class="line">        <span class="keyword">self</span>.<span class="keyword">init</span>(zAngularVelocityDegreesPerMinute: zAngularVelocityDegreesPerMinute,</span><br><span class="line">        needsCorrection: <span class="keyword">self</span>.needsCorrection)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><a target="_blank" rel="noopener" href="https://koenig-media.raywenderlich.com/uploads/2015/11/SwiftInitInDepth-5.png"><img src="http://blog.caohr.com/ImagesFolder/SwiftInitInDepth-5-480x66.png"></a></p>
<p>Compilation fails because delegating initializers cannot actually initialize any properties. Thereâ€™s a good reason for this: the initializer you are delegating to could very well override the value youâ€™ve set, and thatâ€™s not safe. The only thing a delegating initializer can do is manipulate values that are passed into another initializer.</p>
<p>Knowing that, remove the new initializer and give theÂ <code>needsCorrection</code>Â argument of the main initiaziler a default value ofÂ <code>false</code>:</p>
<p>init(zAngularVelocityDegreesPerMinute: Double, needsCorrection: Bool = false) {</p>
<p>UpdateÂ <code>guidanceStatus</code>â€˜s initialization by removing theÂ <code>needsCorrection</code>Â argument:</p>
<p>let guidanceStatus = GuidanceSensorStatus(zAngularVelocityDegreesPerMinute: 2.2)<br>guidanceStatus.currentZAngularVelocityRadiansPerMinute // 0.038<br>guidanceStatus.needsCorrection // false</p>
<h2 id="Introducing-Two-Phase-Initialization"><a href="#Introducing-Two-Phase-Initialization" class="headerlink" title="Introducing Two-Phase Initialization"></a>Introducing Two-Phase Initialization</h2><p>So far, the code in your initializers have been setting up your properties and calling other initializers. Thatâ€™s the first phase of initialization, but there are actually two phases to initializing a Swift type.</p>
<p>Phase 1 starts at the beginning of initialization and ends once all stored properties have been assigned a value. The remaining initialization execution is phase 2. You cannot use the instance you are initializing during phase 1, but youÂ <em>can</em>Â use the instance during phase 2. If you have a chain of delegating initializers, phase 1 spans the call stack up to the non-delegating initializer. Phase 2 spans the return trip from the call stack.</p>
<p><a target="_blank" rel="noopener" href="https://koenig-media.raywenderlich.com/uploads/2015/12/Struct2PhaseInit.png"><img src="http://blog.caohr.com/ImagesFolder/Struct2PhaseInit-700x248.png" alt="Struct2PhaseInit"></a></p>
<h3 id="Putting-Two-Phase-Initialization-to-Work"><a href="#Putting-Two-Phase-Initialization-to-Work" class="headerlink" title="Putting Two-Phase Initialization to Work"></a>Putting Two-Phase Initialization to Work</h3><p>â–¬â–¬â–¬â–¬â–¬â–¬â–¬â–¬â–¬â–¬à®œÛ©ÛÛ©à®œâ–¬â–¬â–¬â–¬â–¬â–¬â–¬â–¬â–¬â–¬â–¬â–¬â–¬â–¬</p>
<p>Now that you understand two-phase initialization, letâ€™s apply it to our scenario. Each rocket engine has a combustion chamber where fuel is injected with oxidizer to create a controlled explosion that propels the rocket. Setting up these parameters is the phase 1 part to prepare for blastoff.</p>
<p>Implement the followingÂ <code>CombustionChamberStatus</code>Â struct to see Swiftâ€™s two-phase initialization in action. Make sure to show Xcodeâ€™s Debug area to see the output of the print statements.</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">CombustionChamberStatus</span> </span>&#123;</span><br><span class="line">        <span class="keyword">var</span> temperatureKelvin: <span class="type">Double</span></span><br><span class="line">        <span class="keyword">var</span> pressureKiloPascals: <span class="type">Double</span></span><br><span class="line">        </span><br><span class="line">        <span class="function"><span class="keyword">init</span>(<span class="params">temperatureKelvin</span>: <span class="type">Double</span>, <span class="params">pressureKiloPascals</span>: <span class="type">Double</span>)</span> &#123;</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">&quot;Phase 1 init&quot;</span>)</span><br><span class="line">                <span class="keyword">self</span>.temperatureKelvin <span class="operator">=</span> temperatureKelvin</span><br><span class="line">                <span class="keyword">self</span>.pressureKiloPascals <span class="operator">=</span> pressureKiloPascals</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">&quot;CombustionChamberStatus fully initialized&quot;</span>)</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">&quot;Phase 2 init&quot;</span>)</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        <span class="function"><span class="keyword">init</span>(<span class="params">temperatureCelsius</span>: <span class="type">Double</span>, <span class="params">pressureAtmospheric</span>: <span class="type">Double</span>)</span> &#123;</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">&quot;Phase 1 delegating init&quot;</span>)</span><br><span class="line">                <span class="keyword">let</span> temperatureKelvin <span class="operator">=</span> temperatureCelsius <span class="operator">+</span> <span class="number">273.15</span></span><br><span class="line">                <span class="keyword">let</span> pressureKiloPascals <span class="operator">=</span> pressureAtmospheric <span class="operator">*</span> <span class="number">101.325</span></span><br><span class="line">                <span class="keyword">self</span>.<span class="keyword">init</span>(temperatureKelvin: temperatureKelvin, pressureKiloPascals: pressureKiloPascals)</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">&quot;Phase 2 delegating init&quot;</span>)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>CombustionChamberStatus(temperatureCelsius: 32, pressureAtmospheric: 0.96)<br>You should see the following output in the Debug Area:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">Phase 1 delegating init</span><br><span class="line">Phase 1 init</span><br><span class="line">CombustionChamberStatus fully initialized</span><br><span class="line">Phase 2 init</span><br><span class="line">Phase 2 delegating init</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>As you can see, phase 1 begins with the call to the delegating initializerÂ <code>init(temperatureCelsius:pressureAtmospheric:)</code>Â during whichÂ <code>self</code>Â cannot be used. Phase 1 ends right afterÂ <code>self.pressureKiloPascals</code>Â gets assigned a value in the non-delegating initializer. Each initializer plays a role during each phase.</p>
<p>Isnâ€™t the compiler super crazy smart? It knows how to enforce all these rules. At first, those rules might seem like nuisances, but remember that they provide a ton of safety.</p>
<h2 id="What-if-Things-Go-Wrong"><a href="#What-if-Things-Go-Wrong" class="headerlink" title="What if Things Go Wrong?"></a>What if Things Go Wrong?</h2><p>Youâ€™ve been told the launch sequence will be fully autonomous, and that the sequence will perform a ton of tests to make sure all systems are good to go for launch. If an invalid value is passed into an initializer, the launch system should be able to know and react.</p>
<p>There are two ways to handle initialization failures in Swift: using failable initializers, and throwing from an initializer. Initialization can fail for many reasons, including invalid input, a missing system resource such as a file, and possible network failures.</p>
<h3 id="Using-Failable-Initializers"><a href="#Using-Failable-Initializers" class="headerlink" title="Using Failable Initializers"></a>Using Failable Initializers</h3><p>å¦‚æœä¼ å…¥çš„å‡½æ•°ä¸ç¬¦åˆåˆå§‹åŒ–çš„è¦æ±‚ï¼Œå¯ä»¥è¿”å›<code>optional</code>çš„åˆå§‹åŒ–ç»“æœã€‚å¯¹äºä¸åˆæ ¼çš„åˆå§‹åŒ–å‚æ•°è¿”å›nilåˆå§‹åŒ–å¤±è´¥ã€‚<br>There are two differences between normal initializers and failable initializers. One is that failable initializers return optional values, and the other is that failable initializers canÂ <code>return nil</code>Â to express an initialization failure. This can be very useful â€” letâ€™s apply it to the rocketâ€™s tanks in our data model.</p>
<p>Each rocket stage carries two large tanks; one holds fuel, while the other holds oxidizer. To keep track of each tank, implement a new struct namedÂ <code>TankStatus</code>Â as follows:</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">TankStatus</span> </span>&#123;</span><br><span class="line">        <span class="keyword">var</span> currentVolume: <span class="type">Double</span></span><br><span class="line">        <span class="keyword">var</span> currentLiquidType: <span class="type">String</span>?</span><br><span class="line">        </span><br><span class="line">        <span class="function"><span class="keyword">init</span>(<span class="params">currentVolume</span>: <span class="type">Double</span>, <span class="params">currentLiquidType</span>: <span class="type">String</span>?)</span> &#123;</span><br><span class="line">                <span class="keyword">self</span>.currentVolume <span class="operator">=</span> currentVolume</span><br><span class="line">                <span class="keyword">self</span>.currentLiquidType <span class="operator">=</span> currentLiquidType</span><br><span class="line">        &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> tankStatus <span class="operator">=</span> <span class="type">TankStatus</span>(currentVolume: <span class="number">0.0</span>, currentLiquidType: <span class="literal">nil</span>)</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>Thereâ€™s nothing wrong with this code except that it doesnâ€™t recognize failure. What happens if you pass in a negative volume? What if you pass in a positive volume value but no liquid type? These are all failure scenarios. How can you model these situatons using failable initializers?</p>
<p>Start by changingÂ <code>TankStatus</code>â€˜s initializer to aÂ <em>failable initializer</em>Â by appending aÂ <code>?</code>Â toÂ <code>init</code>:</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">init?</span>(<span class="params">currentVolume</span>: <span class="type">Double</span>, <span class="params">currentLiquidType</span>: <span class="type">String</span>?)</span> &#123;</span><br></pre></td></tr></table></figure>
<p>Option-click onÂ <code>tankStatus</code>Â and notice how the initializer now returns anÂ <em>optional</em>Â <code>TankStatus</code>.</p>
<p>UpdateÂ <code>tankStatus</code>â€˜s instantiation to match the following:</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> <span class="keyword">let</span> tankStatus <span class="operator">=</span> <span class="type">TankStatus</span>(currentVolume: <span class="number">0.0</span>, currentLiquidType: <span class="literal">nil</span>) &#123;</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;Nice, tank status created.&quot;</span>) <span class="comment">// Printed!</span></span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;Oh no, an initialization failure occurred.&quot;</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>The instantiation logic checks for failure by evaluating whether the returned optional contains a value or not.</p>
<p>Of course, thereâ€™s something missing: the initializer isnâ€™t actually checking for invalid values yet. Update the failable initializer to the following:</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">init?</span>(<span class="params">currentVolume</span>: <span class="type">Double</span>, <span class="params">currentLiquidType</span>: <span class="type">String</span>?)</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> currentVolume <span class="number">0</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">nil</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span> currentVolume <span class="operator">&gt;</span> <span class="number">0</span> <span class="operator">&amp;&amp;</span> currentLiquidType <span class="operator">==</span> <span class="literal">nil</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">nil</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">self</span>.currentVolume <span class="operator">=</span> currentVolume</span><br><span class="line"><span class="keyword">self</span>.currentLiquidType <span class="operator">=</span> currentLiquidType</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>


<p>As soon as an invalid input is detected, the failable initializer returnsÂ <code>nil</code>. You can returnÂ <code>nil</code>Â at any time within a structureâ€™s failable initializer. This isÂ <em>not</em>Â the case with a classâ€™s failable initializer, as youâ€™ll see in Part 2 of this tutorial.</p>
<p>To see instantiation failure, pass an invalid value intoÂ <code>tankStatus</code>â€˜s instantiation:</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> <span class="keyword">let</span> tankStatus <span class="operator">=</span> <span class="type">TankStatus</span>(currentVolume: <span class="operator">-</span><span class="number">10.0</span>, currentLiquidType: <span class="literal">nil</span>) &#123;</span><br></pre></td></tr></table></figure>

<p>Notice how the playground prints, â€œOh no, an initialization failure occurred.â€ Because initialization failed, the failable initializer returned a nil value and theÂ <code>if let</code>Â statement executed theÂ <code>else</code>Â clause.</p>
<h3 id="Throwing-From-an-Initializer"><a href="#Throwing-From-an-Initializer" class="headerlink" title="Throwing From an Initializer"></a>Throwing From an Initializer</h3><p>åœ¨åˆå§‹åŒ–å‡½æ•°ä¸­æŠ›å‡ºé”™è¯¯</p>
<p>Failable initializers are great when returningÂ <code>nil</code>Â is an option. For more serious errors, the other way to handle failure is throwing from an initializer.</p>
<p>You have one last structure to implement: one to represent each astronaut. Start by writing the following code:</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Astronaut</span> </span>&#123;</span><br><span class="line">        <span class="keyword">let</span> name: <span class="type">String</span></span><br><span class="line">        <span class="keyword">let</span> age: <span class="type">Int</span></span><br><span class="line">            </span><br><span class="line">        <span class="function"><span class="keyword">init</span>(<span class="params">name</span>: <span class="type">String</span>, <span class="params">age</span>: <span class="type">Int</span>)</span> &#123;</span><br><span class="line">                <span class="keyword">self</span>.name <span class="operator">=</span> name</span><br><span class="line">                <span class="keyword">self</span>.age <span class="operator">=</span> age</span><br><span class="line">        &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>


<p>The manager tells you an astronaut should have a non-emptyÂ <code>String</code>Â for his or herÂ <code>name</code>Â property and should have anÂ <code>age</code>Â ranging from 18 to 70.</p>
<p>To represent possible errors, add the following error enumerationÂ <em>before</em>Â the implementation ofÂ <code>Astronaut</code>:</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">enum</span> <span class="title">InvalidAstronautDataError</span>: <span class="title">Error</span> </span>&#123;</span><br><span class="line">        <span class="keyword">case</span> <span class="type">EmptyName</span></span><br><span class="line">        <span class="keyword">case</span> <span class="type">InvalidAge</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>


<p>The enumeration cases here cover the possible problems you might run into when initializing a newÂ <code>Astronaut</code>Â instance.</p>
<p>Next, replace the theÂ <code>Astronaut</code>Â initializer with the following implementation:</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">init</span>(<span class="params">name</span>: <span class="type">String</span>, <span class="params">age</span>: <span class="type">Int</span>)</span> <span class="keyword">throws</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> name.isEmpty &#123;</span><br><span class="line">                <span class="keyword">throw</span> <span class="type">InvalidAstronautDataError</span>.<span class="type">EmptyName</span></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> age <span class="number">18</span> <span class="operator">||</span> age <span class="operator">&gt;</span> <span class="number">70</span> &#123;</span><br><span class="line">                <span class="keyword">throw</span> <span class="type">InvalidAstronautDataError</span>.<span class="type">InvalidAge</span></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">self</span>.name <span class="operator">=</span> name</span><br><span class="line">        <span class="keyword">self</span>.age <span class="operator">=</span> age</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>Note that the initializer is now marked asÂ <code>throws</code>Â to let callers know to expect errors.</p>
<p>If an invalid input value is detected â€”Â either an empty string for the name, or an age outside the acceptable range â€” the initializer will now throw the appropriate error.</p>
<p>Try this out by instantiating a new astronaut:</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> johnny <span class="operator">=</span> <span class="keyword">try?</span> <span class="type">Astronaut</span>(name: <span class="string">&quot;Johnny Cosmoseed&quot;</span>, age: <span class="number">42</span>)</span><br></pre></td></tr></table></figure>
<p>This is exactly how you handle any old throwing method or function. Throwing initializers behave just like throwing methods and functions. You can also propagate throwing initializer errors, and handle errors with aÂ <code>do</code>â€“<code>catch</code>Â statement. Nothing new here.</p>
<p>To see the initializer throw an error, changeÂ <code>johnny</code>â€˜s age to 17:</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> johnny <span class="operator">=</span> <span class="keyword">try?</span> <span class="type">Astronaut</span>(name: <span class="string">&quot;Johnny Cosmoseed&quot;</span>, age: <span class="number">17</span>) <span class="comment">// nil</span></span><br></pre></td></tr></table></figure>

<p>When you call a throwing initializer, you write theÂ <code>try</code>Â keyword â€” or theÂ <code>try?</code>Â orÂ <code>try!</code>Â variations â€” to identify that it can throw an error. In this case, you useÂ <code>try?</code>Â so the value returned in the error case is nil. Notice how the value ofÂ <code>johnny</code>Â isÂ <code>nil</code>. Seventeen is too young for spaceflight, sadly. Better luck next year, Johnny!</p>
<h3 id="To-Fail-or-to-Throw"><a href="#To-Fail-or-to-Throw" class="headerlink" title="To Fail or to Throw?"></a>To Fail or to Throw?</h3><p>Initializing using a throwing initializer andÂ <code>try?</code>Â looks an awful lot like initializing with a failable initializer. So which should you use?</p>
<p>Consider using throwing initializers. Failable initializers can only express a binary failure/success situation. By using throwing initializers you can not only indicate failure, but also indicate a reason by throwing specific errors. Another benefit is that calling code can propagate any errors thrown by an initializer.</p>
<p>Failable initializers are much simpler though, since you donâ€™t need to define an error type and you can avoid all those extraÂ <code>try?</code>Â keywords.</p>
<p>Why does Swift even have failable initializers? Because the first version of Swift did not include throwing functions, so the language needed a way to manage initialization failures.</p>
<p>Progress is what gets us to Mars, so we can grow rocks.</p>
<h2 id="Where-To-Go-From-Here"><a href="#Where-To-Go-From-Here" class="headerlink" title="Where To Go From Here?"></a>Where To Go From Here?</h2><p>Wow â€” youâ€™re not only halfway through getting humans to Mars, youâ€™re now a Swift structure initialization guru! You can download the final playground for Part 1Â <a target="_blank" rel="noopener" href="https://koenig-media.raywenderlich.com/uploads/2016/04/BlastOff-Swift3.playground.zip">here</a>.</p>
<p>To learn all about Swift class initialization, carry on toÂ <a target="_blank" rel="noopener" href="https://www.raywenderlich.com/121603/swift-tutorial-initialization-part-2">part 2 of this tutorial</a>.</p>
<p>You can find more information about initialization in theÂ <a target="_blank" rel="noopener" href="https://developer.apple.com/library/ios/documentation/Swift/Conceptual/Swift_Programming_Language/Initialization.html#//apple_ref/doc/uid/TP40014097-CH18-ID203">initialization chapter</a>Â of Appleâ€™sÂ <em>The Swift Programming Language</em>Â guide. If you have any questions or comments, please join the discussion in the forum below!</p>

    </div>

    
    
    

      <footer class="post-footer">
          <div class="post-tags">
              <a href="/tags/Ray-Wenderlich/" rel="tag"># Ray Wenderlich</a>
          </div>

        


        
    <div class="post-nav">
      <div class="post-nav-item">
    <a href="/2021/12/16/Swift/Unicode/" rel="prev" title="Unicode">
      <i class="fa fa-chevron-left"></i> Unicode
    </a></div>
      <div class="post-nav-item">
    <a href="/2021/12/16/Swift/UTF8/" rel="next" title="UTF-8">
      UTF-8 <i class="fa fa-chevron-right"></i>
    </a></div>
    </div>
      </footer>
    
  </article>
  
  
  



          </div>
          
    
  <div class="comments">
    <div id="disqus_thread">
      <noscript>Please enable JavaScript to view the comments powered by Disqus.</noscript>
    </div>
  </div>
  

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          Table of Contents
        </li>
        <li class="sidebar-nav-overview">
          Overview
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
          <div class="post-toc motion-element"><ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#Getting-Started"><span class="nav-number">1.</span> <span class="nav-text">Getting Started</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Banking-on-the-Default-Initializer"><span class="nav-number">2.</span> <span class="nav-text">Banking on the Default Initializer</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Banking-on-the-Memberwise-Initializer"><span class="nav-number">3.</span> <span class="nav-text">Banking on the Memberwise Initializer</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Implementing-a-Custom-Initializer"><span class="nav-number">4.</span> <span class="nav-text">Implementing a Custom Initializer</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Avoiding-Duplication-with-Initializer-Delegation"><span class="nav-number">5.</span> <span class="nav-text">Avoiding Duplication with Initializer Delegation</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Introducing-Two-Phase-Initialization"><span class="nav-number">6.</span> <span class="nav-text">Introducing Two-Phase Initialization</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#Putting-Two-Phase-Initialization-to-Work"><span class="nav-number">6.1.</span> <span class="nav-text">Putting Two-Phase Initialization to Work</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#What-if-Things-Go-Wrong"><span class="nav-number">7.</span> <span class="nav-text">What if Things Go Wrong?</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#Using-Failable-Initializers"><span class="nav-number">7.1.</span> <span class="nav-text">Using Failable Initializers</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Throwing-From-an-Initializer"><span class="nav-number">7.2.</span> <span class="nav-text">Throwing From an Initializer</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#To-Fail-or-to-Throw"><span class="nav-number">7.3.</span> <span class="nav-text">To Fail or to Throw?</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Where-To-Go-From-Here"><span class="nav-number">8.</span> <span class="nav-text">Where To Go From Here?</span></a></li></ol></div>
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="HR"
      src="/images/avatar.png">
  <p class="site-author-name" itemprop="name">HR</p>
  <div class="site-description" itemprop="description">Swimming ğŸŠ in the seağŸŒŠof code!</div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">60</span>
          <span class="site-state-item-name">posts</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
            <a href="/categories/">
          
        <span class="site-state-item-count">10</span>
        <span class="site-state-item-name">categories</span></a>
      </div>
      <div class="site-state-item site-state-tags">
            <a href="/tags/">
          
        <span class="site-state-item-count">16</span>
        <span class="site-state-item-name">tags</span></a>
      </div>
  </nav>
</div>
  <div class="links-of-author motion-element">
      <span class="links-of-author-item">
        <a href="https://github.com/caohrong" title="GitHub â†’ https:&#x2F;&#x2F;github.com&#x2F;caohrong" rel="noopener" target="_blank"><i class="fab fa-github fa-fw"></i>GitHub</a>
      </span>
      <span class="links-of-author-item">
        <a href="mailto:caohr@outlook.com" title="E-Mail â†’ mailto:caohr@outlook.com" rel="noopener" target="_blank"><i class="fa fa-envelope fa-fw"></i>E-Mail</a>
      </span>
      <span class="links-of-author-item">
        <a href="https://weibo.com/caohuanrong" title="Weibo â†’ https:&#x2F;&#x2F;weibo.com&#x2F;caohuanrong" rel="noopener" target="_blank"><i class="fab fa-weibo fa-fw"></i>Weibo</a>
      </span>
  </div>



      </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

        

<div class="copyright">
  
  &copy; 
  <span itemprop="copyrightYear">2022</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">HR</span>
</div>
  <div class="powered-by">Powered by <a href="https://hexo.io/" class="theme-link" rel="noopener" target="_blank">Hexo</a> & <a href="https://pisces.theme-next.org/" class="theme-link" rel="noopener" target="_blank">NexT.Pisces</a>
  </div>

        








      </div>
    </footer>
  </div>

  
  <script src="/lib/anime.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>

<script src="/js/utils.js"></script>

<script src="/js/motion.js"></script>


<script src="/js/schemes/pisces.js"></script>


<script src="/js/next-boot.js"></script>




  
  <script>
    (function(){
      var canonicalURL, curProtocol;
      //Get the <link> tag
      var x=document.getElementsByTagName("link");
		//Find the last canonical URL
		if(x.length > 0){
			for (i=0;i<x.length;i++){
				if(x[i].rel.toLowerCase() == 'canonical' && x[i].href){
					canonicalURL=x[i].href;
				}
			}
		}
    //Get protocol
	    if (!canonicalURL){
	    	curProtocol = window.location.protocol.split(':')[0];
	    }
	    else{
	    	curProtocol = canonicalURL.split(':')[0];
	    }
      //Get current URL if the canonical URL does not exist
	    if (!canonicalURL) canonicalURL = window.location.href;
	    //Assign script content. Replace current URL with the canonical URL
      !function(){var e=/([http|https]:\/\/[a-zA-Z0-9\_\.]+\.baidu\.com)/gi,r=canonicalURL,t=document.referrer;if(!e.test(r)){var n=(String(curProtocol).toLowerCase() === 'https')?"https://sp0.baidu.com/9_Q4simg2RQJ8t7jm9iCKT-xh_/s.gif":"//api.share.baidu.com/s.gif";t?(n+="?r="+encodeURIComponent(document.referrer),r&&(n+="&l="+r)):r&&(n+="?l="+r);var i=new Image;i.src=n}}(window);})();
  </script>















  

  
      

<script>
  if (typeof MathJax === 'undefined') {
    window.MathJax = {
      loader: {
        source: {
          '[tex]/amsCd': '[tex]/amscd',
          '[tex]/AMScd': '[tex]/amscd'
        }
      },
      tex: {
        inlineMath: {'[+]': [['$', '$']]},
        tags: 'ams'
      },
      options: {
        renderActions: {
          findScript: [10, doc => {
            document.querySelectorAll('script[type^="math/tex"]').forEach(node => {
              const display = !!node.type.match(/; *mode=display/);
              const math = new doc.options.MathItem(node.textContent, doc.inputJax[0], display);
              const text = document.createTextNode('');
              node.parentNode.replaceChild(text, node);
              math.start = {node: text, delim: '', n: 0};
              math.end = {node: text, delim: '', n: 0};
              doc.math.push(math);
            });
          }, '', false],
          insertedScript: [200, () => {
            document.querySelectorAll('mjx-container').forEach(node => {
              let target = node.parentNode;
              if (target.nodeName.toLowerCase() === 'li') {
                target.parentNode.classList.add('has-jax');
              }
            });
          }, '', false]
        }
      }
    };
    (function () {
      var script = document.createElement('script');
      script.src = '//cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js';
      script.defer = true;
      document.head.appendChild(script);
    })();
  } else {
    MathJax.startup.document.state(0);
    MathJax.texReset();
    MathJax.typeset();
  }
</script>

    

  

<script>
  function loadCount() {
    var d = document, s = d.createElement('script');
    s.src = 'https://caohr.disqus.com/count.js';
    s.id = 'dsq-count-scr';
    (d.head || d.body).appendChild(s);
  }
  // defer loading until the whole page loading is completed
  window.addEventListener('load', loadCount, false);
</script>
<script>
  var disqus_config = function() {
    this.page.url = "https://blog.caohr.com/2021/12/16/Swift/Swift%20Tutorial:%20Initialization%20In%20Depth%20Part%201/";
    this.page.identifier = "2021/12/16/Swift/Swift Tutorial: Initialization In Depth Part 1/";
    this.page.title = "Swift Tutorial/Initialization In Depth Part 1";
    };
  NexT.utils.loadComments(document.querySelector('#disqus_thread'), () => {
    if (window.DISQUS) {
      DISQUS.reset({
        reload: true,
        config: disqus_config
      });
    } else {
      var d = document, s = d.createElement('script');
      s.src = 'https://caohr.disqus.com/embed.js';
      s.setAttribute('data-timestamp', '' + +new Date());
      (d.head || d.body).appendChild(s);
    }
  });
</script>

</body>
</html>
